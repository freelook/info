/*!
 * Angular Material Design
 * https://github.com/angular/material
 * @license MIT
 * v0.5.1-master-4f755ea
 */
goog.provide('ng.material.components.sticky');
goog.require('ng.material.components.content');
goog.require('ng.material.core');
(function(){function h(h,q,v,n,r){function t(d){function e(){a.items.forEach(g);a.items=a.items.sort(function(b,a){return b.top<a.top?-1:1});for(var b,m=k.prop("scrollTop"),c=a.items.length-1;0<=c;c--)if(m>a.items[c].top){b=a.items[c];break}f(b)}function g(b){var a=b.element[0];b.top=0;for(b.left=0;a&&a!==k[0];)b.top+=a.offsetTop,b.left+=a.offsetLeft,a=a.offsetParent;b.height=b.element.prop("offsetHeight");b.clone.css("margin-left",b.left+"px")}function c(){var b=k.prop("scrollTop"),m=b>(c.prevScrollTop||
0);c.prevScrollTop=b;0===b?f(null):m&&a.next?0>=a.next.top-b?f(a.next):a.current&&(a.next.top-b<=a.next.height?l(a.current,a.next.top-a.next.height-b):l(a.current,null)):!m&&a.current&&(b<a.current.top&&f(a.prev),a.current&&a.next&&(b>=a.next.top-a.current.height?l(a.current,a.next.top-b-a.current.height):l(a.current,null)))}function f(b){a.current!==b&&(a.current&&(l(a.current,null),h(a.current,null)),b&&h(b,"active"),a.current=b,b=a.items.indexOf(b),a.next=a.items[b+1],a.prev=a.items[b-1],h(a.next,
"next"),h(a.prev,"prev"))}function h(b,a){b&&b.state!==a&&(b.state&&(b.clone.attr("sticky-prev-state",b.state),b.element.attr("sticky-prev-state",b.state)),b.clone.attr("sticky-state",a),b.element.attr("sticky-state",a),b.state=a)}function l(a,c){a&&(null===c||void 0===c?a.translateY&&(a.translateY=null,a.clone.css(q.CSS.TRANSFORM,"")):(a.translateY=c,a.clone.css(q.CSS.TRANSFORM,"translate3d("+a.left+"px,"+c+"px,0)")))}var k=d.$element,p=n.debounce(e);u(k);k.on("$scrollstart",p);k.on("$scroll",c);
var a;return a={prev:null,current:null,next:null,items:[],add:function(b,c){c.addClass("md-sticky-clone");var d={element:b,clone:c};a.items.push(d);k.parent().prepend(d.clone);p();return function(){a.items.forEach(function(c,d){c.element[0]===b[0]&&(a.items.splice(d,1),c.clone.remove())});p()}},refreshElements:e}}function u(d){function e(){+r.now()-f>g?(c=!1,d.triggerHandler("$scrollend")):(d.triggerHandler("$scroll"),n(e))}var g=200,c,f;d.on("scroll touchmove",function(){c||(c=!0,n(e),d.triggerHandler("$scrollstart"));
d.triggerHandler("$scroll");f=+r.now()})}var s=function(d){var e;d=angular.element("<div>");h[0].body.appendChild(d[0]);for(var g=["sticky","-webkit-sticky"],c=0;c<g.length;++c)if(d.css({position:g[c],top:0,"z-index":2}),d.css("position")==g[c]){e=g[c];break}d.remove();return e}();return function(d,e,g){var c=e.controller("mdContent");if(c)if(s)e.css({position:s,top:0,"z-index":2});else{var f=c.$element.data("$$sticky");f||(f=t(c),c.$element.data("$$sticky",f));e=f.add(e,g||e.clone());d.$on("$destroy",
e)}}}angular.module("material.components.sticky",["material.core","material.components.content"]).factory("$mdSticky",h);h.$inject=["$document","$mdConstant","$compile","$$rAF","$mdUtil"]})();
